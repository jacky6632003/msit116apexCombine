@using GoogleRecaptchaMvc
@model msit116apexLayout.Models.RegisterViewModel
@{
    ViewBag.Title = "註冊";
}
@section styles{
    <style>
        .tmpDivWidth {
            width: 700px;
        }

        .form-inline {
            margin: 3px;
        }

            .form-inline > label {
                display: inline-block;
            }

        .rFloatLeft {
        }

            .rFloatLeft > div, .rFloatLeft > label, .rFloatLeft > input {
                float: left;
            }
    </style>

}

<div class="row">
    <div class="col-sm-2"></div>
    <div class="col-sm-8">
        <div class="card">
            <h4 class="card-header bg-info text-white">註冊</h4>
            <div class="card-body">
                @using (Html.BeginForm("Register", "Account", FormMethod.Post, new { @class = "form-horizontal tmpDivWidth", role = "form" }))
                {
                    <div class="form-inline">
                        @Html.LabelFor(m => m.Email, new { @class = "col-sm-2 col-form-label xtextAlignRight" })
                        @Html.TextBoxFor(m => m.Email, new { @class = "col-sm-9 form-control" })
                    </div>
                    <div class="form-inline">
                        @Html.LabelFor(m => m.Name, new { @class = "col-sm-2 col-form-label xtextAlignRight" })
                        @Html.EditorFor(m => m.Name, new { htmlAttributes = new { @class = "col-sm-9 form-control" } })
                    </div>
                    <div class="form-inline">
                        @Html.LabelFor(m => m.BirthDay, new { @class = "col-sm-2 col-form-label xtextAlignRight" })
                        @Html.EditorFor(m => m.BirthDay, new { htmlAttributes = new { @class = "col-sm-9 form-control" } })
                    </div>
                    <div class="form-inline">
                        <label class="col-sm-2 col-form-label xtextAlignRight">戶籍地址</label>
                        @*@Html.LabelFor(m => m.ResidenceAddress, new { @class = "col-sm-2 col-form-label xtextAlignRight" })*@
                        @*@Html.TextBoxFor(m => m.ResidenceAddress, new { @class = "col-sm-9 form-control" })*@
                        <div class="rFloatLeft col-sm-9">
                            <label class="form-label" style="width:2.5em;">縣市</label>
                            <div id="selectRCityDiv" style="display:inline-block;"></div>
                            <label class="form-label" style="width:4.5em;">鄉鎮市區</label>
                            <div id="selectRDistrictDiv" style="display:inline-block;">
                                <select class="form-control"><option>請選擇</option></select>
                            </div>
                            <br />
                            <label class="form-label" style="width:8.5em;clear:left">道路或街名或村里</label>
                            <div id="selectRRoadDiv" style="display:inline-block;">
                                <select class="form-control"><option>請選擇</option></select>
                            </div>
                            <label class="form-label" style="width:1.5em">巷</label>
                            <input type="text" name="AddressRLn" id="AddressRLn" class="form-control" style="width:4em" />
                            <br />
                            <label class="form-label" style="width:1.5em;clear:left">弄</label>
                            <input type="text" name="AddressRAly" id="AddressRAly" class="form-control" style="width:4em" />                            
                            <label class="form-label" style="width:1.5em">號</label>
                            <input type="text" name="AddressRNo" id="AddressRNo" class="form-control" style="width:4em" />
                            <label class="form-label" style="width:1.5em">樓</label>
                            <input type="text" name="AddressRF" id="AddressRF" class="form-control" style="width:4em" />
                            <label class="form-label" style="width:1.5em">室</label>
                            <input type="text" name="AddressRRm" id="AddressRRm" class="form-control" style="width:4em" />
                        </div>
                    </div>
                    <div class="form-inline">
                        @Html.LabelFor(m => m.IdentityCardNumber, new { @class = "col-sm-2 col-form-label xtextAlignRight" })
                        @Html.EditorFor(m => m.IdentityCardNumber, new { htmlAttributes = new { @class = "col-sm-9 form-control" } })
                    </div>
                    <div class="form-inline">
                        @Html.LabelFor(m => m.Password, new { @class = "col-sm-2 col-form-label xtextAlignRight" })
                        @Html.PasswordFor(m => m.Password, new { @class = "col-sm-9 form-control" })
                    </div>
                    <div class="form-inline">
                        @Html.LabelFor(m => m.ConfirmPassword, new { @class = "col-sm-2 col-form-label xtextAlignRight" })
                        @Html.PasswordFor(m => m.ConfirmPassword, new { @class = "col-sm-9 form-control" })
                    </div>
                    <script src='https://www.google.com/recaptcha/api.js'></script>
                    <div class="form-inline">
                        <div class="col-sm-2"></div>
                        @Html.RecaptchaV2("6LfqzzcUAAAAAMh8ccBhPoZasdTLMohzY1TNk2_2")
                    </div>
                    <div class="form-inline">
                        <div class="col-sm-2"></div>
                        <label for="dontcheckgrc">Demo 不進行GoogleRecaptcha檢查</label>
                        <input id="dontcheckgrc" name="dontcheckgrc" type="checkbox" />
                    </div>
                    <div class="form-inline">
                        <div class="col-sm-2"></div>
                        <button id="demoRegisterBtn" type="button">Demo</button>
                        <label for="dontcheckemail">Demo 不進行Email驗證</label>
                        <input id="dontcheckemail" name="dontcheckemail" type="checkbox" />
                        <input id="isDemoing" type="hidden"/>
                    </div>
                    <div class="form-inline">
                        <div class="col-sm-2"></div>
                        <label for="registerEmployee">Demo 是員工</label>
                        <input id="registerEmployee" name="registerEmployee" type="checkbox" />
                    </div>
                    <div class="form-inline">
                        <div class="col-sm-2"></div>
                        <button id="clearDemoAccountBtn" type="button">Demo 將Demo帳號清空</button>
                    </div>
                    <div class="form-inline">
                        <div class="col-sm-2"></div>
                        <input type="submit" class="btn btn-primary" value="註冊" />
                    </div>
                }
            </div>
        </div>
    </div>


</div>


@section scripts{
    <script>
        $(function () {
            $.get("@Url.Action("GetCityList", "Account",new { area=""})", null, function (data) {
                var sx1s = $('<select id="selectRCity" name="selectRCity"></select>').addClass('form-control').prepend("<option value=''>請選擇</option>");
                $.each(data, function (idv, objv) {
                    var sx1 = $("<option></option>")
                        .attr("value", objv.Id)
                        .text(objv.Name);
                    sx1s.append(sx1);
                });

                $('#selectRCityDiv').html(sx1s);

            });
            $('#selectRCityDiv').on('change','#selectRCity',function () {
                var CityId = $(this).children('option:selected').val();
                $.get("@Url.Action("GetDistrictList", "Account",new { area=""})?CityId=" + CityId, null, function (data) {
                    var sx1s = $('<select id="selectRDistrict" name="selectRDistrict"></select>').addClass('form-control').prepend("<option value=''>請選擇</option>");
                    $.each(data, function (idv, objv) {
                        var sx1 = $("<option></option>")
                            .attr("value", objv.Id)
                            .text(objv.Name);
                        sx1s.append(sx1);
                    });

                    $('#selectRDistrictDiv').html(sx1s);
                    if ($('#isDemoing').val() == "Demo") {
                        var randomDistrict = parseInt((($('#selectRDistrict').children().length - 2) * Math.random()) + 1)
                        $('#selectRDistrict').val($('#selectRDistrict').children().eq(randomDistrict).val());
                        $('#selectRDistrict').change();
                    }

                });
            });
            $('#selectRDistrictDiv').on('change','#selectRDistrict',function () {
                var DistrictId = $(this).children('option:selected').val();
                $.get("@Url.Action("GetRoadList", "Account",new { area=""})?DistrictId=" + DistrictId, null, function (data) {
                    var sx1s = $('<select id="selectRRoad" name="selectRRoad"></select>').addClass('form-control').prepend("<option value=''>請選擇</option>");
                    $.each(data, function (idv, objv) {
                        var sx1 = $("<option></option>")
                            .attr("value", objv.Id)
                            .text(objv.Name);
                        sx1s.append(sx1);
                    });

                    $('#selectRRoadDiv').html(sx1s);
                    if ($('#isDemoing').val() == "Demo") {
                        var randomRoad = parseInt((($('#selectRRoad').children().length - 2) * Math.random()) + 1)
                        $('#selectRRoad').val($('#selectRRoad').children().eq(randomRoad).val());
                        $('#isDemoing').val("");
                    }
                });
            });
            $('#demoRegisterBtn').click(function () {
                $('#isDemoing').val("Demo");
                $('#Password').val("P@ssw0rd");
                $('#ConfirmPassword').val("P@ssw0rd");
                var randomCity = parseInt((($('#selectRCity').children().length-2) * Math.random())+1)
                $('#selectRCity').val(randomCity);
                $('#selectRCity').change();
                var randomRLn = parseInt((100 * Math.random()) + 1);
                $('#AddressRLn').val(randomRLn);
                var randomRAly = parseInt((100 * Math.random()) + 1);
                $('#AddressRAly').val(randomRAly);
                var randomRNo = parseInt((700 * Math.random()) + 1);
                $('#AddressRNo').val(randomRNo);
                var randomRF = parseInt((20 * Math.random()) + 1);
                $('#AddressRF').val(randomRF);
                var randomRRm = parseInt((5 * Math.random()) + 1);
                $('#AddressRRm').val(randomRRm);
                $('#IdentityCardNumber').val("A123456789");
                $('#Name').val("葉俊緯");
                $('#Email').val("ycwaspclient@gmail.com");
                $('#IdentityCardNumber').val("A123456789");
                var now = new Date();

                var day = ("0" + now.getDate()).slice(-2);
                var month = ("0" + (now.getMonth() + 1)).slice(-2);
                var randomYear = parseInt((10 * Math.random()) + 1985);
                var today = randomYear + "-" + (month) + "-" + (day);
                $('#BirthDay').val(today);
                $('#dontcheckgrc').prop("checked", true);
                $('#dontcheckemail').prop("checked", true);
                $('#registerEmployee').prop("checked", true);
            });
            $('#clearDemoAccountBtn').click(function () {
                $.get('@Url.Action("setDemoAccountDefault", "Test",new { area=""})', null, function (data) {
                    alert(data);
                });
            });
        });
    </script>
}